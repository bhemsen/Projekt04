import mysql.connector


class Database: 
    def __init__(self,host, user, password,database):
        self.host = host
        self.user = user
        self.password = password
        self.database = database

        self.mydb = mysql.connector.connect(
        host=self.host,
        user=self.user,
        password=self.password,
        database=self.database
        )

        self.cursor = self.mydb.cursor(prepared=True)

    def createTabel(self, tablename):
        sql = "IF NOT EXITS CREATE TABLE "+tablename+" values "
        # CREATE TABLE `projekt04`.`tablename` ( `ID` INT(10) NOT NULL AUTO_INCREMENT ,  `name` VARCHAR(20) NOT NULL ,  `test` FLOAT(20) NOT NULL ,  `test2` MEDIUMINT(20) NOT NULL ,    PRIMARY KEY  (`ID`)) ENGINE = InnoDB;



    def getAbteilungen(self):
        sql = "SELECT ID, Abteilung FROM abteilungen"
        data = []

        self.cursor.execute(sql)

        result = self.cursor.fetchall()

        for row in result:
            row = list(row)
            data.append(row)

        print (data)
        return data